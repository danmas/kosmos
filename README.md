# Kosmos Panel ‚Äî –ø–∞–Ω–µ–ª—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞–º–∏ (Node.js + –≤–∞–Ω–∏–ª—å–Ω—ã–π JS)

–ê–≥–µ–Ω—Ç‚Äëless –ø–∞–Ω–µ–ª—å –≤ —Å—Ç–∏–ª–µ ¬´–∫–æ—Å–º–∏—á–µ—Å–∫–æ–π –ø—Ä–∏–±–æ—Ä–∫–∏¬ª: –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ SSH/HTTP/TCP, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å—ã, –¥–∞—ë—Ç –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ —Ç–µ—Ä–º–∏–Ω–∞–ª—É (xterm.js) –∏ —Ö–≤–æ—Å—Ç–∞–º –ª–æ–≥–æ–≤. **–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π AI-–ø–æ–º–æ—â–Ω–∏–∫** –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∫–æ–º–∞–Ω–¥—ã –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ –≤ shell-–∫–æ–º–∞–Ω–¥—ã –ø—Ä—è–º–æ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ. –§—Ä–æ–Ω—Ç ‚Äî —á–∏—Å—Ç—ã–π JavaScript, –±—ç–∫ ‚Äî Node.js.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑ –∞–≥–µ–Ω—Ç–æ–≤:
  - HTTP, HTTP JSON (JSONPath), TCP –ø–æ—Ä—Ç, TLS —Å—Ä–æ–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
  - systemd unit, –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–∞—è SSH‚Äë–∫–æ–º–∞–Ω–¥–∞ (regex‚Äë–ø–∞—Ç—Ç–µ—Ä–Ω —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏)
  - Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (—á–µ—Ä–µ–∑ `docker ps` –ø–æ SSH)
- –ü–ª–∏—Ç–∫–∏ —Å–µ—Ä–≤–µ—Ä–æ–≤ (—Ü–≤–µ—Ç: green/yellow/red/gray), —Ç—É–ª—Ç–∏–ø—ã —Å–æ —Å–≤–æ–¥–∫–æ–π
- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è: —Ç–µ—Ä–º–∏–Ω–∞–ª SSH (xterm.js), tail –ª–æ–≥–æ–≤, ssh:// –∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã
- –ü–ª–∞–≤–∞—é—â–∏–µ –æ–∫–Ω–∞ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞/tail (–Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ) –∏ –æ—Ç–¥–µ–ª—å–Ω–∞—è –≤–∫–ª–∞–¥–∫–∞ `/term.html`
- **AI-–∫–æ–º–∞–Ω–¥—ã –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ**: –≤–≤–µ–¥–∏—Ç–µ `ai: –≤–∞—à –∑–∞–ø—Ä–æ—Å` –∏ –ø–æ–ª—É—á–∏—Ç–µ –≥–æ—Ç–æ–≤—É—é shell-–∫–æ–º–∞–Ω–¥—É
- –ì–æ—Ä—è—á–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ `inventory.json` (–±–µ–∑ —Ä–µ—Å—Ç–∞—Ä—Ç–æ–≤)

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Windows)
–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è: Node.js 18+.
```powershell
npm install
npm start
```
–û—Ç–∫—Ä–æ–π—Ç–µ `http://localhost:3000`. 

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ü—Ä–æ–µ–∫—Ç –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ–∞–π–ª–∞:

1.  **`inventory.json`** ‚Äî –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–ø–∏—Å–æ–∫ —Å–µ—Ä–≤–µ—Ä–æ–≤, –∏—Ö —Å–µ—Ä–≤–∏—Å—ã –∏ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –∫ –Ω–∏–º —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è SSH. –§–∞–π–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö.
2.  **`.env`** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤: –ø–∞—Ä–æ–ª–µ–π, –ø–∞—Ä–æ–ª—å–Ω—ã—Ö —Ñ—Ä–∞–∑ –∏ –ø—É—Ç–µ–π –∫ SSH-–∫–ª—é—á–∞–º. –°–æ–∑–¥–∞–π—Ç–µ –µ–≥–æ –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ –ø—Ä–∏–º–µ—Ä—É `.env.example`.

### `inventory.json`

–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä:
```json
{
  "credentials": [
    {
      "id": "cred-sample",
      "type": "ssh-key",
      "privateKeyPath": "C:/Users/you/.ssh/id_ed25519",
      "passphrase": null,
      "useAgent": false
    }
  ],
  "servers": [
    {
      "id": "usa",
      "name": "usa",
      "env": "prod",
      "ssh": { "host": "usa", "port": 22, "user": "root", "credentialId": "cred-sample" },
      "services": [
        { "id": "web", "type": "http", "name": "Web", "url": "http://usa:3002", "expectStatus": 200 }
      ]
    }
  ],
  "poll": { "intervalSec": 15, "concurrency": 6 }
}
```
–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Å–µ—Ä–≤–∏—Å—ã: `http`, `httpJson`, `tcp`, `tls`, `systemd`, `sshCommand`, `dockerContainer`. –ü–æ–¥—Ä–æ–±–Ω–æ –ø—Ä–æ SSH/–∫—Ä–µ–¥—ã/–æ—Ç–ª–∞–¥–∫—É ‚Äî `README_AUTH.md`.

### `.env`

–≠—Ç–æ—Ç —Ñ–∞–π–ª –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –¥–æ–ª–∂–Ω—ã –ø–æ–ø–∞–¥–∞—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É –∫–æ–Ω—Ç—Ä–æ–ª—è –≤–µ—Ä—Å–∏–π. –ü—Ä–∏–º–µ—Ä:

```bash
# –ü—É—Ç—å –∫ –ø—Ä–∏–≤–∞—Ç–Ω–æ–º—É SSH-–∫–ª—é—á—É
SSH_KEY_PATH=C:/Users/you/.ssh/id_ed25519

# –ü–∞—Ä–æ–ª—å–Ω–∞—è —Ñ—Ä–∞–∑–∞ –¥–ª—è –∫–ª—é—á–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)
SSH_PASSPHRASE=

# –ü–∞—Ä–æ–ª—å –¥–ª—è SSH-–¥–æ—Å—Ç—É–ø–∞ (–µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–ª—é—á)
SSH_PASSWORD=your_secret_password

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏ SSH-–∞–≥–µ–Ω—Ç (true/false)
USE_SSH_AGENT=false

# AI Configuration (–¥–ª—è AI-–∫–æ–º–∞–Ω–¥ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
AI_SERVER_URL=http://localhost:3002/api/send-request
AI_MODEL=moonshotai/kimi-dev-72b:free
AI_PROVIDER=openroute
AI_SYSTEM_PROMPT=You are a Linux terminal AI assistant. Your task is to convert the user's request into a valid shell command, and return ONLY the shell command itself without any explanation.
```

–ó–Ω–∞—á–µ–Ω–∏—è –∏–∑ —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ –ø–æ–¥—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –≤ `inventory.json`, –µ—Å–ª–∏ —Ç–∞–º –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã –≤–∏–¥–∞ `${VAR_NAME}`.

## –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- –ü–ª–∏—Ç–∫–∏ ‚Üí hover: —Ç—É–ª—Ç–∏–ø; click: –º–µ–Ω—é –¥–µ–π—Å—Ç–≤–∏–π
- –ú–µ–Ω—é: —Ç–µ—Ä–º–∏–Ω–∞–ª/tail –≤–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–º –æ–∫–Ω–µ, –≤ –ø–ª–∞–≤–∞—é—â–∏—Ö –æ–∫–Ω–∞—Ö –∏ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ (`/term.html`)
- –¢–µ—Ä–º–∏–Ω–∞–ª ‚Äî xterm.js: —Ü–≤–µ—Ç–∞, UTF‚Äë8, –ø—Ä–æ–∫—Ä—É—Ç–∫–∞; –≤–≤–æ–¥ –∏–¥—ë—Ç –ø—Ä—è–º–æ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª
- **AI-–∫–æ–º–∞–Ω–¥—ã**: `ai: –ø–æ–∫–∞–∂–∏ —Ñ–∞–π–ª—ã` ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è `ls -la`
- **–†–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**: –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ —Å—Å—ã–ª–∫–µ "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏" –∏–ª–∏ `/inventory-editor.html`

üìñ **–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ç–µ—Ä–º–∏–Ω–∞–ª—É**: [README_terminal.md](README_terminal.md)

### –†–µ–¥–∞–∫—Ç–æ—Ä inventory.json

–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤–µ–±-—Ä–µ–¥–∞–∫—Ç–æ—Ä –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π —Å–µ—Ä–≤–µ—Ä–æ–≤ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ JSON —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- ‚úÖ **–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä** ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–æ–≤, —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å–µ—Ä–≤–µ—Ä–∞–º** ‚Äî –±—ã—Å—Ç—Ä—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –∫ –Ω—É–∂–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—É –≤ JSON
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –∫—Ä–∞—Å–∏–≤–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ JSON
- ‚úÖ **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ backup'—ã –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π –∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ ID
- ‚úÖ **–ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏** ‚Äî Ctrl+S (—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å), Ctrl+Shift+F (—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å)
- ‚úÖ **–®–∞–±–ª–æ–Ω—ã** ‚Äî –±—ã—Å—Ç—Ä–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ –∏ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å:**
- **–í–∫–ª–∞–¥–∫–∞ JSON** ‚Äî —Ä–µ–¥–∞–∫—Ç–æ—Ä —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- **–í–∫–ª–∞–¥–∫–∞ "–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä"** ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- **–ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å** ‚Äî —Å–ø–∏—Å–æ–∫ —Å–µ—Ä–≤–µ—Ä–æ–≤ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
- **–°—Ç–∞—Ç—É—Å-–±–∞—Ä** ‚Äî –ø–æ–∑–∏—Ü–∏—è –∫—É—Ä—Å–æ—Ä–∞, —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞, —Å—Ç–∞—Ç—É—Å –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **–ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π** ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å

**–î–æ—Å—Ç—É–ø:**
```
http://localhost:3000/inventory-editor.html
```

–ò–ª–∏ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏" –≤ –≤–µ—Ä—Ö–Ω–µ–π –ø–∞–Ω–µ–ª–∏ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

üìñ **–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: [KB/README_INVENTORY_EDITOR.md](KB/README_INVENTORY_EDITOR.md)

## API/WS

### REST API
- `GET /api/servers` ‚Äî –ø–æ–ª—É—á–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ –∏ —Å–µ—Ä–≤–∏—Å–æ–≤
- `GET /api/inventory` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –∫—Ä–∞—Ç–∫–∏–π —Å–ø–∏—Å–æ–∫ —Å–µ—Ä–≤–µ—Ä–æ–≤ –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏  
- `GET /inventory.json` ‚Äî –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª–Ω—ã–π —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–¥–ª—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞)
- `POST /api/inventory` ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–æ–≤—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (—Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –∏ backup)
- `POST /api/reload` ‚Äî –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ —Ñ–∞–π–ª–∞
- `GET /api/test-ssh?serverId=...` ‚Äî —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å SSH-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É

### WebSocket
- `/ws/terminal?serverId=...&cols=120&rows=30` ‚Äî –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π SSH-—Ç–µ—Ä–º–∏–Ω–∞–ª
- `/ws/tail?serverId=...&path=/var/log/syslog&lines=200` ‚Äî –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ª–æ–≥–æ–≤

**–°–æ–æ–±—â–µ–Ω–∏—è WS:**
```json
{
  "type": "data|err|fatal|ai_query",
  "data": "—Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–ª—è –≤—ã–≤–æ–¥–∞",
  "error": "—Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ", 
  "prompt": "AI-–∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
}
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞