{
  "credentials": [
    {
      "id": "cred-sample",
      "type": "ssh-key",
      "privateKeyPath": "${SSH_KEY_PATH}",
      "passphrase": "${SSH_PASSPHRASE}",
      "password": "${SSH_PASSWORD}",
      "useAgent": "${USE_SSH_AGENT}"
    },
    {
      "id": "cred-w2-office",
      "type": "ssh-key",
      "privateKeyPath": "${SSH_KEY_PATH}",
      "passphrase": "${SSH_PASSPHRASE}",
      "password": "##dxsage17",
      "useAgent": "${USE_SSH_AGENT}"
    }
  ],
  "servers": [
    {
      "id": "w2-from-office",
      "name": "w2",
      "env": "prod",
      "ssh": {
        "host": "w2.carlinkmail.ru",
        "port": 22,
        "user": "deployer",
        "credentialId": "cred-w2-office"
      },
      "services": [
        {
          "id": "api-http",
          "type": "http",
          "name": "API",
          "url": "http://127.0.0.1:8080/health",
          "expectStatus": 200,
          "timeoutMs": 2000
        },
        {
          "id": "api-json",
          "type": "httpJson",
          "name": "API JSON",
          "url": "http://127.0.0.1:8080/health",
          "timeoutMs": 2000,
          "rules": [
            {
              "name": "ok flag",
              "path": "$.ok",
              "equals": true
            },
            {
              "name": "version exists",
              "path": "$.version",
              "exists": true
            }
          ]
        },
        {
          "id": "nginx",
          "type": "systemd",
          "name": "nginx",
          "service": "nginx",
          "timeoutMs": 3000
        },
        {
          "id": "redis",
          "type": "tcp",
          "name": "redis",
          "host": "127.0.0.1",
          "port": 6379,
          "timeoutMs": 1500
        },
        {
          "id": "pg",
          "type": "sshCommand",
          "name": "postgres",
          "command": "pg_isready",
          "okPattern": "accepting connections",
          "timeoutMs": 3000
        },
        {
          "id": "tls-google",
          "type": "tls",
          "name": "google tls",
          "host": "google.com",
          "port": 443,
          "minDaysLeft": 7
        },
        {
          "id": "docker-api",
          "type": "dockerContainer",
          "name": "api-container",
          "container": "api"
        }
      ]
    },
    {
      "id": "api-prod-1",
      "name": "API Prod 1",
      "env": "prod",
      "ssh": {
        "host": "127.0.0.1",
        "port": 22,
        "user": "ubuntu",
        "credentialId": "cred-sample"
      },
      "services": [
        {
          "id": "api-http",
          "type": "http",
          "name": "API",
          "url": "http://127.0.0.1:8080/health",
          "expectStatus": 200,
          "timeoutMs": 2000
        },
        {
          "id": "api-json",
          "type": "httpJson",
          "name": "API JSON",
          "url": "http://127.0.0.1:8080/health",
          "timeoutMs": 2000,
          "rules": [
            {
              "name": "ok flag",
              "path": "$.ok",
              "equals": true
            },
            {
              "name": "version exists",
              "path": "$.version",
              "exists": true
            }
          ]
        },
        {
          "id": "nginx",
          "type": "systemd",
          "name": "nginx",
          "service": "nginx",
          "timeoutMs": 3000
        },
        {
          "id": "redis",
          "type": "tcp",
          "name": "redis",
          "host": "127.0.0.1",
          "port": 6379,
          "timeoutMs": 1500
        },
        {
          "id": "pg",
          "type": "sshCommand",
          "name": "postgres",
          "command": "pg_isready",
          "okPattern": "accepting connections",
          "timeoutMs": 3000
        },
        {
          "id": "tls-google",
          "type": "tls",
          "name": "google tls",
          "host": "google.com",
          "port": 443,
          "minDaysLeft": 7
        },
        {
          "id": "docker-api",
          "type": "dockerContainer",
          "name": "api-container",
          "container": "api"
        }
      ]
    },
    {
      "id": "test-1",
      "name": "Test Box",
      "env": "test",
      "ssh": {
        "host": "127.0.0.1",
        "port": 22,
        "user": "ubuntu",
        "credentialId": "cred-sample"
      },
      "services": [
        {
          "id": "web",
          "type": "http",
          "name": "Web",
          "url": "http://127.0.0.1:80/",
          "expectStatus": 200,
          "timeoutMs": 2000
        }
      ]
    },
    {
      "id": "usa",
      "name": "usa",
      "env": "prod",
      "ssh": {
        "host": "usa",
        "port": 22,
        "user": "root",
        "credentialId": "cred-sample"
      },
      "services": [
        {
          "id": "aian-model",
          "type": "http",
          "name": "AIAN Model (3002)",
          "url": "http://usa:3002",
          "expectStatus": 200,
          "timeoutMs": 3000
        },
        {
          "id": "aian-vector",
          "type": "http",
          "name": "AIAN Vector (3005)",
          "url": "http://usa:3005",
          "expectStatus": 200,
          "timeoutMs": 3000
        },
        {
          "id": "eng-teach",
          "type": "http",
          "name": "Eng Verbs (3000)",
          "url": "http://usa:3000",
          "expectStatus": 200,
          "timeoutMs": 3000
        },
        {
          "id": "searxng-docker",
          "type": "dockerContainer",
          "name": "searxng (doc)",
          "container": "searxng",
          "timeoutMs": 3000
        },
        {
          "id": "searxng-http",
          "type": "http",
          "name": "searxng (8080)",
          "url": "http://usa:8080/search?q=tes",
          "expectStatus": 200,
          "timeoutMs": 3000
        }
      ]
    }
  ],
  "poll": {
    "intervalSec": 15,
    "concurrency": 6
  }
}